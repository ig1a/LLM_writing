# 书籍RAG聊天小程序

这是一个基于微信小程序的应用，允许用户通过扫描书籍的条形码，与由书中内容驱动的大语言模型(LLM)进行对话交流。

## 功能特点

- **扫码识别**：支持扫描书籍条形码，自动识别书籍信息
- **智能对话**：基于书籍内容的RAG技术，提供智能问答服务
- **Material Design**：采用现代化的Material Design设计风格
- **Vue3技术栈**：使用Vue3框架开发，提供流畅的用户体验

## 项目结构

```
frontend/
├── README.md                 # 项目说明文档
├── project.config.json       # 项目配置文件
├── app.js                    # 小程序入口文件
├── app.json                  # 小程序全局配置
├── app.wxss                  # 小程序全局样式
├── utils/                    # 工具函数目录
│   └── request.js            # 网络请求封装
├── components/               # 组件目录
│   ├── chat-bubble/          # 聊天气泡组件
│   └── loading/              # 加载组件
└── pages/                    # 页面目录
    ├── index/                # 首页(初始界面)
    │   ├── index.js          # 首页逻辑
    │   ├── index.wxml        # 首页结构
    │   ├── index.wxss        # 首页样式
    │   └── index.json        # 首页配置
    ├── scanner/              # 扫码页面
    │   ├── scanner.js
    │   ├── scanner.wxml
    │   ├── scanner.wxss
    │   └── scanner.json
    └── chat/                 # 聊天页面
        ├── chat.js
        ├── chat.wxml
        ├── chat.wxss
        └── chat.json
```

## 测试指南

### 测试用ISBN码

以下是一些常见书籍的ISBN码，可用于测试扫码和聊天功能：

| 书名                       | ISBN              | 备注                     |
|----------------------------|-------------------|--------------------------|
| 三体                       | 9787536692930     | 刘慈欣科幻小说           |
| 活着                       | 9787506365437     | 余华著名小说             |
| 人类简史                   | 9787508647357     | 尤瓦尔·赫拉利历史著作    |
| 百年孤独                   | 9787544253994     | 加西亚·马尔克斯经典      |
| 解忧杂货店                 | 9787544270878     | 东野圭吾推理小说         |
| 小王子                     | 9787540478698     | 安东尼·德·圣-埃克苏佩里  |
| 围城                       | 9787020090006     | 钱钟书经典小说           |
| 追风筝的人                 | 9787208061644     | 卡勒德·胡赛尼小说        |

### 功能测试途径

#### 首页测试
- 打开小程序，检查首页UI显示是否正常
- 点击"开始扫码"按钮，应跳转到扫码页面

#### 扫码页面测试
- 手动输入ISBN：在输入框中输入上述任一ISBN码，点击"确认"按钮
- 扫码功能：使用相机扫描实体书籍条形码
- 取消功能：点击"取消"按钮，应返回首页

#### 聊天页面测试
- 书籍信息卡片：验证书籍标题、作者、出版社等信息显示
- 消息发送：在输入框中输入问题并发送
- AI回复：验证AI是否根据书籍内容提供相关回复
- 长按消息：测试复制文本功能
- 返回功能：点击左上角返回按钮，应返回首页

### 开发者测试数据
如需在无API环境下测试，可在utils/request.js中添加mock数据进行功能验证。

前后端请参考README-BackendIntegration.md！那个文档里有详细说明！

## 开发环境设置

### 前置条件
- 微信开发者工具：[下载地址](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- 微信小程序账号（可使用测试号进行开发）
- 后端服务（参考backend目录下的README.md）

### 本地开发步骤

1. **安装微信开发者工具**
   - 下载并安装最新版本的微信开发者工具
   - 使用微信扫码登录

2. **导入小程序项目**
   - 打开微信开发者工具
   - 点击左上角的"+"号，选择"导入项目"
   - 项目目录选择`frontend`文件夹
   - AppID填写您的小程序AppID（如果没有，可以选择"测试号"）
   - 点击"导入"按钮

3. **配置后端服务地址**
   - 打开`utils/config.js`文件
   - 修改`API.BASE_URL`为您的后端服务地址：
     ```javascript
     // 修改为您的后端服务器地址
     BASE_URL: 'http://localhost:8080',
     ```
     如果是在本地开发，可以保持默认值

4. **编译和预览**
   - 点击工具栏上的"编译"按钮
   - 左侧会显示小程序模拟器，可以在上面测试功能
   - 也可以点击工具栏上的"预览"按钮，生成二维码，用微信扫码在手机上预览

### 调试技巧

1. **使用控制台调试**
   - 开发者工具右侧有"调试器"面板
   - "Console"标签页可以查看日志输出
   - 在代码中使用`console.log()`输出调试信息

2. **网络请求调试**
   - "Network"标签页可以监控所有网络请求
   - 可以查看请求参数、响应数据和状态码

3. **存储调试**
   - "Storage"标签页可以查看和修改本地存储数据
   - 包括本地缓存、用户数据等

4. **使用测试模式**
   - 在`utils/config.js`中设置`DEV.TEST_MODE = true`
   - 这将使用预设的测试数据，而不是真实API调用

### 常见问题

1. **无法连接后端服务**
   - 确保后端服务已启动
   - 检查`config.js`中的`BASE_URL`是否正确
   - 确认本地网络连接正常

2. **微信登录失败**
   - 确保在开发者工具中使用了正确的AppID
   - 检查后端服务的微信配置是否正确

3. **扫码功能不工作**
   - 在真机调试时，确保已经授权相机权限
   - 在模拟器中，可以手动输入ISBN进行测试

4. **界面显示异常**
   - 检查CSS样式和适配问题
   - 尝试在不同尺寸的设备上测试

## 部署指南

### 上传代码
1. 在微信开发者工具中点击"上传"按钮
2. 填写版本号和项目备注
3. 点击"上传"

### 提交审核
1. 登录[微信公众平台](https://mp.weixin.qq.com/)
2. 进入"开发管理" -> "开发版本管理"
3. 选择要提交的版本，点击"提交审核"
4. 填写相关信息并提交

### 发布上线
审核通过后，可以在微信公众平台将小程序发布到线上环境。